// script.js
document.addEventListener('DOMContentLoaded', function() {
    const yearCards = document.querySelectorAll('.year-card');
    const streamsView = document.getElementById('streams-view');
    const streamsList = document.getElementById('streams-list');
    const yearTitle = document.querySelector('.year-title');
    const backButton = document.querySelector('.back-button');
    
    // Пример данных стримов (в реальности это может быть AJAX запрос к API)
    const streamsData = {
        '2022': [
            { id: 1, title: 'Играем в Minecraft', date: '15.03.2022', duration: '2:45:12', thumbnail: 'https://via.placeholder.com/300x180' },
            { id: 2, title: 'Новая игра: Elden Ring', date: '22.03.2022', duration: '4:12:33', thumbnail: 'https://via.placeholder.com/300x180' }
        ],
        '2023': [
            { id: 3, title: 'Марафон стримов', date: '10.01.2023', duration: '6:22:45', thumbnail: 'https://via.placeholder.com/300x180' },
            { id: 4, title: 'Специальный ивент', date: '18.02.2023', duration: '3:45:11', thumbnail: 'https://via.placeholder.com/300x180' },
            { id: 5, title: 'Q&A с подписчиками', date: '05.05.2023', duration: '2:12:09', thumbnail: 'https://via.placeholder.com/300x180' }
        ],
        '2024': [
            { id: 6, title: 'Новый проект', date: '12.01.2024', duration: '3:22:18', thumbnail: 'https://via.placeholder.com/300x180' },
            { id: 7, title: 'Коллаб с другими стримерами', date: '28.02.2024', duration: '5:11:42', thumbnail: 'https://via.placeholder.com/300x180' }
        ],
        '2025': []
    };
    
    // Обработчик клика по карточке года
    yearCards.forEach(card => {
        card.addEventListener('click', function(e) {
            e.preventDefault();
            const year = this.getAttribute('data-year');
            showStreamsForYear(year);
        });
    });
    
    // Обработчик кнопки "Назад"
    backButton.addEventListener('click', function() {
        hideStreamsView();
    });
    
    // Функция показа стримов для выбранного года
    function showStreamsForYear(year) {
        // Устанавливаем заголовок
        yearTitle.textContent = `Стримы ${year} года`;
        
        // Очищаем список стримов
        streamsList.innerHTML = '';
        
        // Получаем стримы для выбранного года
        const streams = streamsData[year] || [];
        
        if (streams.length === 0) {
            streamsList.innerHTML = '<p>Пока нет стримов за этот год.</p>';
        } else {
            // Создаем карточки для каждого стрима
            streams.forEach(stream => {
                const streamCard = document.createElement('div');
                streamCard.className = 'stream-card';
                streamCard.innerHTML = `
                    <img src="${stream.thumbnail}" alt="${stream.title}" class="stream-thumbnail">
                    <div class="stream-info">
                        <div class="stream-date">${stream.date}</div>
                        <h3 class="stream-title">${stream.title}</h3>
                        <div class="stream-duration">${stream.duration}</div>
                    </div>
                `;
                streamsList.appendChild(streamCard);
            });
        }
        
        // Показываем контейнер со стримами
        document.querySelector('.years-grid').style.display = 'none';
        streamsView.classList.add('active');
        
        // Прокручиваем к началу списка стримов
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    }
    
    // Функция скрытия списка стримов
    function hideStreamsView() {
        streamsView.classList.remove('active');
        setTimeout(() => {
            document.querySelector('.years-grid').style.display = 'grid';
        }, 500); // Ждем завершения анимации opacity
        
        // Прокручиваем к началу страницы
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    }
    
    // Обработка хэша в URL (например, site.com#2023)
    if (window.location.hash) {
        const yearFromHash = window.location.hash.substring(1);
        if (streamsData.hasOwnProperty(yearFromHash)) {
            showStreamsForYear(yearFromHash);
        }
    }
});